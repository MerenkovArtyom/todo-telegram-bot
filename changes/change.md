Изменения и логика

Цель: привести текстовый поток задач к единой модели, убрать рассинхрон типов, нормализовать пользовательские сообщения и сделать структуру более понятной для обучения/поддержки. Голосовой ввод не трогался.

1) Единая модель и репозиторий
- app/schemas/task.py
  - Добавил TaskRecord (id + Task) и сделал Task неизменяемым (frozen=True).
  - Логика: задания в БД имеют идентификатор, поэтому в коде удобнее явно разделять данные задачи и запись из БД.
- app/db/tasks_repo.py
  - add_task теперь принимает Task и возвращает id.
  - get_tasks возвращает список TaskRecord.
  - Введены функции сериализации/десериализации даты (ISO-формат) для стабильного хранения/чтения.
  - Логика: единый тип данных устраняет ошибки, когда в функции передаются строки вместо Task.

2) Сервисный слой для задач
- app/services/tasks.py
  - create_tasks: извлекает задачи из текста и сохраняет их.
  - list_tasks: возвращает список задач пользователя.
  - delete_task_by_index: удаляет задачу по индексу в списке.
  - Логика: обработчики бота больше не знают о деталях БД и извлечения, только про бизнес-операции.
- app/services/__init__.py
  - Экспорт ключевых функций.

3) Сообщения бота в одном месте
- app/bot/messages.py
  - Все тексты ответов собраны в одном модуле.
  - Логика: легко менять формулировки и локализацию без правки бизнес-логики.

4) Обработчики текстовых команд
- app/bot/handlers/text.py
  - Переписан с использованием services и messages.
  - Добавлен вывод даты в списке, если она есть.
  - Логика: минимальная ответственность обработчиков, стабильный UX.

5) Нормализация текста задач и дат
- app/llm/task_extractor.py
  - Разделение задач по "и", очистка слов "сегодня/завтра/послезавтра" и дат.
  - Возврат пустого списка при пустом вводе.
  - Логика: корректные названия задач без служебных слов, но с сохранением due_date.
- app/dates/parser.py
  - Обновлены русские ключевые слова и аккуратный разбор дат.
  - Логика: исключение "кракозябр" и явная поддержка русских формулировок.

6) Конфигурация
- app/config.py
  - Исправлен текст ошибки при отсутствии BOT_TOKEN.
  - Логика: читаемая ошибка вместо поврежденной кодировки.

7) Зависимости
- requirements.txt
  - Убраны неиспользуемые пакеты, добавлен openai-whisper (реально используется импорт whisper).
  - Логика: минимальный и правдивый список зависимостей облегчает настройку окружения.

Итоговый эффект
- Типы данных выровнены по всему текстовому потоку.
- Ответы бота читаемы и централизованы.
- Даты хранятся и читаются устойчиво.
- Архитектура стала понятнее для изучения: handlers -> services -> repo -> db.

Что сознательно не менялось
- Голосовой ввод и связанные обработчики/ASR.
